name: Self-Service Create Cluster

on:
  issues:
    types: [labeled]

jobs:
  debug:
    runs-on: ubuntu-latest
    steps:
      - name: Debug Labels
        run: |
          echo "ğŸ·ï¸ Label that triggered this workflow: ${{ github.event.label.name }}"
          echo "ğŸ“‹ All labels on issue: ${{ join(github.event.issue.labels.*.name, ', ') }}"
          echo ""
          echo "Condition 1 - Is triggering label 'approved'?"
          echo "  github.event.label.name == 'approved' â†’ ${{ github.event.label.name == 'approved' }}"
          echo ""
          echo "Condition 2 - Does issue have 'cluster-create' label?"
          echo "  contains cluster-create â†’ ${{ contains(github.event.issue.labels.*.name, 'cluster-create') }}"

  create-cluster:
    needs: debug
    if: github.event.label.name == 'approved' && contains(github.event.issue.labels.*.name, 'cluster-create')
    runs-on: ubuntu-latest
    steps:
      - run: echo "Job is running!"
